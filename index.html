<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>–ò–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        body {
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            background: #F7F7F7;
            touch-action: pan-x pan-y;
            -webkit-tap-highlight-color: transparent;
            overflow-x: hidden;
            color: #1A1A1A;
            overscroll-behavior: none;
        }

        header {
            background: #FFFFFF;
            border-bottom: 1px solid #E0E0E0;
            padding: 10px 12px;
            position: sticky;
            top: 0;
            z-index: 1000;
            padding-top: calc(10px + env(safe-area-inset-top));
        }

        .header-container {
            max-width: 1440px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            gap: 8px;
            flex-wrap: wrap;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: clamp(1.2rem, 4vw, 1.4rem);
            font-weight: 700;
            color: #6B00F5;
            text-decoration: none;
        }

        .catalog-btn {
            display: flex;
            align-items: center;
            gap: 6px;
            background: #6B00F5;
            color: #FFFFFF;
            border: none;
            padding: 8px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-size: clamp(0.8rem, 3vw, 0.9rem);
            font-weight: 500;
            transition: background 0.2s ease;
            min-height: 48px;
        }

        .catalog-btn:hover {
            background: #5200E0;
        }

        @media (hover: none) {
            .catalog-btn:hover {
                background: #6B00F5;
            }
        }

        #search-container {
            flex: 1;
            max-width: 500px;
            position: relative;
        }

        #search {
            width: 100%;
            padding: 8px 36px 8px 12px;
            border: 1px solid #E0E0E0;
            border-radius: 6px;
            font-size: clamp(0.8rem, 3vw, 0.9rem);
            background: #FFFFFF;
            transition: border-color 0.2s, box-shadow 0.2s;
            min-height: 48px;
        }

        #search:focus {
            outline: none;
            border-color: #6B00F5;
            box-shadow: 0 0 0 2px rgba(107, 0, 245, 0.1);
        }

        #search-icon {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            color: #757575;
            font-size: 1rem;
        }

        .header-icons {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .header-icon {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            color: #1A1A1A;
            text-decoration: none;
            font-size: clamp(0.75rem, 2.5vw, 0.85rem);
            font-weight: 500;
            padding: 6px;
            border-radius: 6px;
            transition: background 0.2s ease;
            min-height: 48px;
        }

        .header-icon:hover {
            background: #F0F0F0;
        }

        @media (hover: none) {
            .header-icon:hover {
                background: none;
            }
        }

        .cart-count {
            background: #FF3B3B;
            color: #FFFFFF;
            border-radius: 50%;
            padding: 2px 5px;
            font-size: 0.7rem;
            line-height: 1;
        }

        .cart-icon.shake {
            animation: shake 0.3s ease-in-out;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-3px); }
            50% { transform: translateX(3px); }
            75% { transform: translateX(-3px); }
        }

        .language-switcher select {
            padding: 5px 20px 5px 6px;
            border: 1px solid #E0E0E0;
            border-radius: 5px;
            font-size: clamp(0.75rem, 2.5vw, 0.85rem);
            background: #FFFFFF;
            cursor: pointer;
            appearance: none;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" viewBox="0 0 12 12"><path fill="%23757575" d="M6 9l4-5H2z"/></svg>');
            background-repeat: no-repeat;
            background-position: right 6px center;
            min-height: 48px;
        }

        #catalog-sidebar {
            position: fixed;
            top: 0;
            left: calc(-1 * min(80vw, 280px));
            width: min(80vw, 280px);
            height: 100%;
            background: #FFFFFF;
            box-shadow: 2px 0 6px rgba(0, 0, 0, 0.1);
            z-index: 2000;
            transition: left 0.3s ease;
            overflow-y: auto;
            padding: 12px;
        }

        #catalog-sidebar.active {
            left: 0;
        }

        #catalog-close, #catalog-back {
            background: none;
            border: none;
            font-size: 1.1rem;
            cursor: pointer;
            position: absolute;
            top: 12px;
            color: #1A1A1A;
            min-height: 48px;
            min-width: 48px;
        }

        #catalog-close {
            right: 12px;
        }

        #catalog-back {
            left: 12px;
            display: none;
        }

        .catalog-item {
            padding: 10px 0;
            border-bottom: 1px solid #E0E0E0;
        }

        .catalog-item-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            cursor: pointer;
            font-size: clamp(0.85rem, 3vw, 0.9rem);
            font-weight: 500;
            color: #1A1A1A;
            padding: 6px 0;
            min-height: 48px;
        }

        .catalog-item-header:hover {
            color: #6B00F5;
        }

        @media (hover: none) {
            .catalog-item-header:hover {
                color: #1A1A1A;
            }
        }

        .catalog-subitems {
            display: none;
            padding-left: 12px;
            margin-top: 6px;
        }

        .catalog-subitems.active {
            display: block;
        }

        .catalog-subitem {
            padding: 6px 0;
            font-size: clamp(0.8rem, 2.5vw, 0.85rem);
            color: #757575;
            cursor: pointer;
            min-height: 48px;
        }

        .catalog-subitem:hover {
            color: #6B00F5;
        }

        @media (hover: none) {
            .catalog-subitem:hover {
                color: #757575;
            }
        }

        #catalog-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1500;
            display: none;
        }

        #catalog-overlay.active {
            display: block;
        }

        main {
            flex: 1;
            padding: 12px;
            padding-top: calc(70px + env(safe-area-inset-top));
            padding-bottom: calc(12px + env(safe-area-inset-bottom));
            max-width: 1440px;
            margin: 0 auto;
            width: 100%;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            justify-content: center;
            align-items: center;
            z-index: 2000;
            padding: 12px;
            padding-top: env(safe-area-inset-top);
            padding-bottom: env(safe-area-inset-bottom);
            overscroll-behavior: contain;
        }

        .modal-content {
            background: #FFFFFF;
            padding: 20px;
            border-radius: 10px;
            width: 100%;
            max-width: 450px;
            max-height: calc(100vh - 24px - env(safe-area-inset-top) - env(safe-area-inset-bottom));
            overflow-y: auto;
            text-align: center;
            box-shadow: 0 3px 12px rgba(0, 0, 0, 0.2);
        }

        .form-group {
            margin-bottom: 12px;
        }

        .form-group input, .form-group select {
            width: 100%;
            padding: 8px;
            border: 1px solid #E0E0E0;
            border-radius: 6px;
            font-size: clamp(0.85rem, 3vw, 0.9rem);
            background: #FFFFFF;
            transition: border-color 0.2s, box-shadow 0.2s;
            min-height: 48px;
        }

        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: #6B00F5;
            box-shadow: 0 0 0 2px rgba(107, 0, 245, 0.2);
        }

        .product-card {
            background: #FFFFFF;
            border-radius: 8px;
            padding: 10px;
            text-align: center;
            box-shadow: 0 1px 4px rgba(0, 0, 0, 0.08);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .product-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.12);
        }

        @media (hover: none) {
            .product-card:hover {
                transform: none;
                box-shadow: 0 1px 4px rgba(0, 0, 0, 0.08);
            }
        }

        .product-card img {
            width: 100%;
            height: 80px;
            object-fit: cover;
            border-radius: 4px;
            margin-bottom: 8px;
            loading: lazy;
        }

        .product-card h3 {
            font-size: clamp(0.8rem, 3vw, 0.85rem);
            margin: 4px 0;
            color: #1A1A1A;
            line-height: 1.3;
            height: 2.6em;
            overflow: hidden;
            text-overflow: ellipsis;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
        }

        .product-card p {
            font-size: clamp(0.85rem, 3vw, 0.9rem);
            color: #6B00F5;
            font-weight: 600;
            margin-bottom: 6px;
        }

        .product-card .description {
            font-size: clamp(0.7rem, 2.5vw, 0.75rem);
            color: #757575;
            margin-bottom: 8px;
            height: 2.25em;
            overflow: hidden;
            text-overflow: ellipsis;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
        }

        .product-card button {
            background: #6B00F5;
            color: #FFFFFF;
            border: none;
            padding: 8px;
            border-radius: 6px;
            cursor: pointer;
            font-size: clamp(0.75rem, 2.5vw, 0.8rem);
            width: 100%;
            font-weight: 500;
            transition: background 0.2s ease;
            min-height: 48px;
        }

        .product-card button:hover {
            background: #5200E0;
        }

        @media (hover: none) {
            .product-card button:hover {
                background: #6B00F5;
            }
        }

        footer {
            background: #1A1A1A;
            color: #FFFFFF;
            padding: 32px 12px;
            padding-bottom: calc(32px + env(safe-area-inset-bottom));
            margin-top: 32px;
        }

        .footer-container {
            max-width: 1440px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 20px;
        }

        .footer-section {
            font-size: clamp(0.8rem, 2.5vw, 0.85rem);
        }

        .footer-section h4 {
            font-size: clamp(0.9rem, 3vw, 0.95rem);
            margin-bottom: 12px;
            font-weight: 600;
        }

        .footer-section p, .footer-section a {
            color: #B0BEC5;
            margin-bottom: 6px;
            text-decoration: none;
            font-size: clamp(0.8rem, 2.5vw, 0.85rem);
        }

        .footer-section a:hover {
            color: #FFFFFF;
            text-decoration: underline;
        }

        @media (hover: none) {
            .footer-section a:hover {
                color: #B0BEC5;
                text-decoration: none;
            }
        }

        .footer-logo {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: clamp(1.2rem, 4vw, 1.4rem);
            font-weight: 700;
            color: #FFFFFF;
            margin-bottom: 12px;
        }

        .footer-bottom {
            text-align: center;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid #37474F;
            font-size: clamp(0.75rem, 2.5vw, 0.8rem);
            color: #B0BEC5;
        }

        /* Face ID Modal */
        .face-id-modal {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: #FFFFFF;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 3px 12px rgba(0, 0, 0, 0.2);
            z-index: 2500;
            max-width: 300px;
        }

        .face-id-modal img {
            width: 60px;
            height: 60px;
            margin-bottom: 10px;
        }

        /* Media Queries */
        @media (max-width: 360px) {
            #productList {
                grid-template-columns: 1fr;
            }

            .header-container {
                flex-direction: column;
                align-items: stretch;
                gap: 6px;
            }

            .modal-content, .face-id-modal {
                max-width: 95%;
                padding: 10px;
            }

            #catalog-sidebar {
                padding: 8px;
            }

            #catalog-close, #catalog-back {
                top: 8px;
            }
        }

        @media (max-width: 640px) {
            .header-container {
                flex-direction: column;
                align-items: stretch;
                padding: 0 6px;
                gap: 6px;
            }

            #search-container {
                max-width: 100%;
            }

            .modal-content, .face-id-modal {
                max-width: 90%;
                padding: 12px;
            }

            #productList {
                grid-template-columns: repeat(2, minmax(0, 1fr));
            }

            .product-card img {
                height: 60px;
            }

            .product-card h3 {
                font-size: 0.75rem;
            }

            .product-card .description {
                font-size: 0.7rem;
            }

            .product-card button {
                font-size: 0.75rem;
                padding: 5px;
            }
        }

        @media (max-width: 768px) {
            .footer-container {
                grid-template-columns: 1fr;
                text-align: center;
            }
        }

        @media (min-width: 640px) and (max-width: 1024px) {
            #productList {
                grid-template-columns: repeat(3, minmax(0, 1fr));
            }
        }

        @media (min-width: 1024px) and (max-width: 1280px) {
            #productList {
                grid-template-columns: repeat(4, minmax(0, 1fr));
            }
        }

        @media (min-width: 1280px) {
            #productList {
                grid-template-columns: repeat(5, minmax(0, 1fr));
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <div class="header-container">
            <a href="#" class="logo" id="siteTitle">–ò–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω</a>
            <button class="catalog-btn" id="catalogButton">–ö–∞—Ç–∞–ª–æ–≥</button>
            <div id="search-container">
                <input type="text" id="search" placeholder="–ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤...">
                <span id="search-icon">üîç</span>
            </div>
            <div class="header-icons">
                <div class="relative header-icon">
                    <button id="cartButton" class="cart-icon">üõí</button>
                    <span id="cartCount" class="cart-count">0</span>
                </div>
                <a href="#" class="header-icon" id="authButton">–í–æ–π—Ç–∏</a>
                <div class="language-switcher">
                    <select id="languageSelect">
                        <option value="ru" selected>–†—É—Å—Å–∫–∏–π</option>
                        <option value="uz">O'zbek</option>
                    </select>
                </div>
            </div>
        </div>
    </header>

    <!-- Catalog Sidebar -->
    <div id="catalog-sidebar">
        <button id="catalog-back">‚Üê</button>
        <button id="catalog-close">‚úñ</button>
        <div class="catalog-item">
            <div class="catalog-item-header" id="cat-manga">–ú–∞–Ω–≥–∞ <span>‚ñº</span></div>
            <div class="catalog-subitems">
                <div class="catalog-subitem">–°—ë–Ω–µ–Ω</div>
                <div class="catalog-subitem">–°—ç–π–Ω—ç–Ω</div>
            </div>
        </div>
        <div class="catalog-item">
            <div class="catalog-item-header" id="cat-clothing">–û–¥–µ–∂–¥–∞ <span>‚ñº</span></div>
            <div class="catalog-subitems">
                <div class="catalog-subitem">–§—É—Ç–±–æ–ª–∫–∏</div>
                <div class="catalog-subitem">–î–∂–∏–Ω—Å—ã</div>
            </div>
        </div>
        <div class="catalog-item">
            <div class="catalog-item-header" id="cat-footwear">–û–±—É–≤—å <span>‚ñº</span></div>
            <div class="catalog-subitems">
                <div class="catalog-subitem">–ö—Ä–æ—Å—Å–æ–≤–∫–∏</div>
                <div class="catalog-subitem">–°–∞–ø–æ–≥–∏</div>
            </div>
        </div>
        <div class="catalog-item">
            <div class="catalog-item-header" id="cat-food">–ï–¥–∞ <span>‚ñº</span></div>
            <div class="catalog-subitems">
                <div class="catalog-subitem" id="sub-kfc">KFC</div>
                <div class="catalog-subitem" id="sub-other-restaurants">–î—Ä—É–≥–∏–µ —Ä–µ—Å—Ç–æ—Ä–∞–Ω—ã</div>
            </div>
        </div>
    </div>
    <div id="catalog-overlay"></div>

    <!-- Main Content -->
    <main>
        <!-- Profile Section -->
        <div id="profileSection" class="bg-white p-3 rounded shadow mb-3 hidden">
            <h2 class="text-base font-bold mb-3" id="profileTitle">–ü—Ä–æ—Ñ–∏–ª—å</h2>
            <div id="profileDetails">
                <p><strong id="nameLabel">–ò–º—è:</strong> <span id="profileName"></span></p>
                <p><strong id="phoneLabel">–¢–µ–ª–µ—Ñ–æ–Ω:</strong> <span id="profilePhone"></span></p>
            </div>
            <button id="editProfile" class="bg-[#6B00F5] text-white px-3 py-1 mt-2 rounded text-sm min-h-[48px]">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å</button>
            <button id="logoutButton" class="bg-[#FF3B3B] text-white px-3 py-1 mt-2 rounded text-sm min-h-[48px]">–í—ã–π—Ç–∏</button>
        </div>

        <!-- Product Catalog -->
        <h2 class="text-xl font-bold mb-3" id="catalogTitle">–ö–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä–æ–≤</h2>
        <div id="productList" class="grid gap-3"></div>
    </main>

    <!-- Cart Modal -->
    <div id="cartModal" class="modal">
        <div class="modal-content">
            <h2 class="text-base font-bold mb-3" id="cartTitle">–ö–æ—Ä–∑–∏–Ω–∞</h2>
            <div id="cartItems"></div>
            <div class="form-group">
                <input type="text" id="discountCode" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø—Ä–æ–º–æ–∫–æ–¥" class="p-2 border rounded text-sm min-h-[48px]">
                <button id="applyDiscount" class="bg-[#6B00F5] text-white px-3 py-1 mt-2 rounded text-sm min-h-[48px]">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
            </div>
            <p id="cartTotal" class="text-base font-bold mt-3"></p>
            <div class="flex justify-end gap-3 mt-3">
                <button id="closeCart" class="bg-[#B0BEC5] text-white px-3 py-1 rounded text-sm min-h-[48px]">–ó–∞–∫—Ä—ã—Ç—å</button>
                <button id="checkoutButton" class="bg-[#6B00F5] text-white px-3 py-1 rounded text-sm min-h-[48px]">–û—Ñ–æ—Ä–º–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- Checkout Modal -->
    <div id="checkoutModal" class="modal">
        <div class="modal-content">
            <h2 class="text-base font-bold mb-3" id="checkoutTitle">–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞</h2>
            <form id="checkoutForm" class="space-y-3">
                <div class="form-group">
                    <input type="text" id="firstName" placeholder="–ò–º—è" class="w-full text-sm" required>
                </div>
                <div class="form-group">
                    <input type="text" id="lastName" placeholder="–§–∞–º–∏–ª–∏—è" class="w-full text-sm" required>
                </div>
                <div class="form-group">
                    <input type="tel" id="phone" placeholder="–ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞" class="w-full text-sm" required pattern="\+\d{10,12}">
                </div>
                <div class="form-group">
                    <input type="text" id="smsCode" placeholder="–ö–æ–¥ –∏–∑ SMS" class="w-full text-sm" required>
                </div>
                <div class="form-group">
                    <input type="text" id="address" placeholder="–ê–¥—Ä–µ—Å" class="w-full text-sm" required>
                </div>
                <div class="form-group">
                    <select id="paymentMethod" class="w-full text-sm">
                        <option value="cash">–ù–∞–ª–∏—á–Ω—ã–µ</option>
                        <option value="card">–ö–∞—Ä—Ç–∞</option>
                        <option value="credit">–ö—Ä–µ–¥–∏—Ç</option>
                    </select>
                </div>
                <div id="cardDetails" class="hidden space-y-3">
                    <div class="form-group">
                        <input type="text" id="cardNumber" placeholder="–ù–æ–º–µ—Ä –∫–∞—Ä—Ç—ã" class="w-full text-sm" pattern="\d{16}" title="–í–≤–µ–¥–∏—Ç–µ 16-–∑–Ω–∞—á–Ω—ã–π –Ω–æ–º–µ—Ä –∫–∞—Ä—Ç—ã" required>
                    </div>
                    <div class="form-group">
                        <input type="text" id="cardExpiry" placeholder="–ú–ú/–ì–ì" class="w-full text-sm" pattern="\d{2}/\d{2}" title="–í–≤–µ–¥–∏—Ç–µ —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ –ú–ú/–ì–ì" required>
                    </div>
                    <div class="form-group">
                        <input type="text" id="cardCVV" placeholder="CVV" class="w-full text-sm" pattern="\d{3}" title="–í–≤–µ–¥–∏—Ç–µ 3-–∑–Ω–∞—á–Ω—ã–π CVV" required>
                    </div>
                </div>
                <div id="creditDetails" class="hidden space-y-3">
                    <div class="form-group">
                        <label for="carat" class="block text-sm font-medium mb-1">–ö–∞—Ä–∞—Ç</label>
                        <select id="carat" class="w-full text-sm">
                            <option value="18K">18K</option>
                            <option value="22K">22K</option>
                            <option value="24K">24K</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <input type="text" id="passportId" placeholder="–ü–∞—Å–ø–æ—Ä—Ç ID" class="w-full text-sm" pattern="[A-Z0-9]{9}" title="–í–≤–µ–¥–∏—Ç–µ 9-–∑–Ω–∞—á–Ω—ã–π –ø–∞—Å–ø–æ—Ä—Ç ID (–±—É–∫–≤—ã –∏ —Ü–∏—Ñ—Ä—ã)" required>
                    </div>
                </div>
                <div class="form-group">
                    <button type="button" id="faceIdCheckout" class="bg-[#6B00F5] text-white w-full p-2 rounded text-sm min-h-[48px]">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å —Å Face ID</button>
                </div>
                <div class="flex justify-end gap-3">
                    <button type="button" id="closeCheckout" class="bg-[#B0BEC5] text-white px-3 py-1 rounded text-sm min-h-[48px]">–û—Ç–º–µ–Ω–∞</button>
                    <button type="submit" class="bg-[#6B00F5] text-white px-3 py-1 rounded text-sm min-h-[48px]">–†–∞–∑–º–µ—Å—Ç–∏—Ç—å –∑–∞–∫–∞–∑</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Receipt Modal -->
    <div id="receiptModal" class="modal">
        <div class="modal-content">
            <h2 class="text-base font-bold mb-3" id="receiptTitle">–ß–µ–∫ –∑–∞–∫–∞–∑–∞</h2>
            <div id="receiptContent" class="text-sm text-left"></div>
            <div class="flex justify-end gap-3 mt-3">
                <button id="downloadReceipt" class="bg-[#6B00F5] text-white px-3 py-1 rounded text-sm min-h-[48px]">–°–∫–∞—á–∞—Ç—å —á–µ–∫</button>
                <button id="closeReceipt" class="bg-[#B0BEC5] text-white px-3 py-1 rounded text-sm min-h-[48px]">–ó–∞–∫—Ä—ã—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- Auth Modal -->
    <div id="authModal" class="modal">
        <div class="modal-content">
            <h2 class="text-base font-bold mb-3" id="authTitle">–í—Ö–æ–¥ / –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h2>
            <button id="googleLogin" class="bg-[#FF3B3B] text-white w-full p-2 mb-3 rounded text-sm min-h-[48px]">–í–æ–π—Ç–∏ —á–µ—Ä–µ–∑ Google</button>
            <button id="faceIdLogin" class="bg-[#6B00F5] text-white w-full p-2 mb-3 rounded text-sm min-h-[48px]">–í–æ–π—Ç–∏ —Å Face ID</button>
            <form id="authForm" class="space-y-3">
                <div class="form-group">
                    <input type="text" id="authFirstName" placeholder="–ò–º—è" class="w-full text-sm" required>
                </div>
                <div class="form-group">
                    <input type="tel" id="authPhone" placeholder="–ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞" class="w-full text-sm">
                </div>
                <div class="form-group">
                    <input type="password" id="authPassword" placeholder="–ü–∞—Ä–æ–ª—å" class="w-full text-sm">
                </div>
                <div class="flex justify-end gap-3">
                    <button type="button" id="closeAuth" class="bg-[#B0BEC5] text-white px-3 py-1 rounded text-sm min-h-[48px]">–û—Ç–º–µ–Ω–∞</button>
                    <button type="submit" class="bg-[#6B00F5] text-white px-3 py-1 rounded text-sm min-h-[48px]">–í–æ–π—Ç–∏</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Face ID Modal -->
    <div id="faceIdModal" class="modal" style="display: none;">
        <div class="face-id-modal">
            <img src="https://via.placeholder.com/60?text=FaceID" alt="Face ID">
            <p id="faceIdText" class="text-sm">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ —Å –ø–æ–º–æ—â—å—é Face ID</p>
            <button id="confirmFaceId" class="bg-[#6B00F5] text-white w-full p-2 rounded text-sm min-h-[48px] mt-3">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å</button>
            <button id="cancelFaceId" class="bg-[#B0BEC5] text-white w-full p-2 rounded text-sm min-h-[48px] mt-2">–û—Ç–º–µ–Ω–∞</button>
        </div>
    </div>

    <!-- Footer -->
    <footer>
        <div class="footer-container">
            <div class="footer-section">
                <div class="footer-logo" id="footerLogo">–ò–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω</div>
                <p>¬© 2025 –ò–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</p>
            </div>
            <div class="footer-section">
                <h4 id="footerContactTitle">–ö–æ–Ω—Ç–∞–∫—Ç—ã</h4>
                <p id="footerContact">support@shop.com</p>
                <p>+123-456-7890</p>
            </div>
            <div class="footer-section">
                <h4 id="footerLinksTitle">–°—Å—ã–ª–∫–∏</h4>
                <p id="footerLinks">
                    <a href="#" class="underline">–û –Ω–∞—Å</a><br>
                    <a href="#" class="underline">–£—Å–ª–æ–≤–∏—è</a><br>
                    <a href="#" class="underline">–ö–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å</a>
                </p>
            </div>
            <div class="footer-section">
                <h4 id="footerSocialTitle">–°–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–µ—Ç–∏</h4>
                <p>
                    <a href="#" class="underline">Twitter</a><br>
                    <a href="#" class="underline">Instagram</a><br>
                    <a href="#" class="underline">Facebook</a>
                </p>
            </div>
        </div>
        <div class="footer-bottom" id="footerCopyright">¬© 2025 –ò–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</div>
    </footer>

    <script>
        // Product data
        const products = [
            { id: 1, title: "–ù–∞—Ä—É—Ç–æ –¢. 1", price: 9.99, image: "https://via.placeholder.com/100", description: "–≠–∫—à–Ω-–ø—Ä–∏–∫–ª—é—á–µ–Ω–∏–µ –Ω–∏–Ω–¥–∑—è.", category: "manga" },
            { id: 2, title: "–í–∞–Ω –ü–∏—Å –¢. 1", price: 10.99, image: "https://via.placeholder.com/100", description: "–≠–ø–∏—á–µ—Å–∫–æ–µ –ø–∏—Ä–∞—Ç—Å–∫–æ–µ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ.", category: "manga" },
            { id: 3, title: "–§—É—Ç–±–æ–ª–∫–∞ –∞–Ω–∏–º–µ", price: 15.99, image: "https://via.placeholder.com/100", description: "–•–ª–æ–ø–∫–æ–≤–∞—è —Ñ—É—Ç–±–æ–ª–∫–∞ —Å –ø—Ä–∏–Ω—Ç–æ–º.", category: "clothing" },
            { id: 4, title: "–î–∂–∏–Ω—Å—ã —É–∑–∫–∏–µ", price: 29.99, image: "https://via.placeholder.com/100", description: "–°—Ç–∏–ª—å–Ω—ã–µ –¥–∂–∏–Ω—Å—ã –¥–ª—è –ø–æ–≤—Å–µ–¥–Ω–µ–≤–∫–∏.", category: "clothing" },
            { id: 5, title: "–ö—Ä–æ—Å—Å–æ–≤–∫–∏ Nike", price: 59.99, image: "https://via.placeholder.com/100", description: "–£–¥–æ–±–Ω—ã–µ –∫—Ä–æ—Å—Å–æ–≤–∫–∏ –¥–ª—è —Å–ø–æ—Ä—Ç–∞.", category: "footwear" },
            { id: 6, title: "–°–∞–ø–æ–≥–∏ –∑–∏–º–Ω–∏–µ", price: 45.99, image: "https://via.placeholder.com/100", description: "–¢–µ–ø–ª—ã–µ —Å–∞–ø–æ–≥–∏ –¥–ª—è –∑–∏–º—ã.", category: "footwear" },
            { id: 7, title: "–ß–∏–ø—Å—ã Lay's", price: 2.99, image: "https://via.placeholder.com/100", description: "–•—Ä—É—Å—Ç—è—â–∏–µ —á–∏–ø—Å—ã —Å —Å–æ–ª—å—é.", category: "food" },
            { id: 8, title: "–ö–æ–ª–∞ 1–ª", price: 1.99, image: "https://via.placeholder.com/100", description: "–û—Å–≤–µ–∂–∞—é—â–∏–π –Ω–∞–ø–∏—Ç–æ–∫.", category: "food" },
            { id: 9, title: "KFC –ó–∏–Ω–≥–µ—Ä –ë—É—Ä–≥–µ—Ä", price: 3.50, image: "https://via.placeholder.com/100", description: "–°–æ—á–Ω—ã–π –±—É—Ä–≥–µ—Ä —Å –∫—É—Ä–∏—Ü–µ–π.", category: "kfc" },
            { id: 10, title: "KFC –û—Å—Ç—Ä—ã–µ –ö—Ä—ã–ª—ã—à–∫–∏", price: 4.50, image: "https://via.placeholder.com/100", description: "–û—Å—Ç—Ä—ã–µ –∫—É—Ä–∏–Ω—ã–µ –∫—Ä—ã–ª—ã—à–∫–∏.", category: "kfc" },
            { id: 11, title: "KFC –¢–≤–∏—Å—Ç–µ—Ä", price: 3.00, image: "https://via.placeholder.com/100", description: "–ö—É—Ä–∏–Ω—ã–π —Ä–æ–ª–ª —Å –æ–≤–æ—â–∞–º–∏.", category: "kfc" },
            { id: 12, title: "–ü–ª–æ–≤ –¢–∞—à–∫–µ–Ω—Ç—Å–∫–∏–π", price: 6.99, image: "https://via.placeholder.com/100", description: "–¢—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–π —É–∑–±–µ–∫—Å–∫–∏–π –ø–ª–æ–≤.", category: "food" },
            { id: 13, title: "–°–∞–º—Å–∞ —Å –≥–æ–≤—è–¥–∏–Ω–æ–π", price: 2.49, image: "https://via.placeholder.com/100", description: "–°–ª–æ–µ–Ω–∞—è —Å–∞–º—Å–∞ —Å –º—è—Å–æ–º.", category: "food" },
            { id: 14, title: "–®–∞—É—Ä–º–∞", price: 4.49, image: "https://via.placeholder.com/100", description: "–®–∞—É—Ä–º–∞ —Å –∫—É—Ä–∏—Ü–µ–π –∏ –æ–≤–æ—â–∞–º–∏.", category: "food" },
            { id: 15, title: "–õ–∞–≥–º–∞–Ω", price: 5.99, image: "https://via.placeholder.com/100", description: "–£–∑–±–µ–∫—Å–∫–∏–π —Å—É–ø —Å –ª–∞–ø—à–æ–π.", category: "food" }
        ];

        // Language translations
        const translations = {
            ru: {
                siteTitle: "–ò–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω",
                catalogTitle: "–ö–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä–æ–≤",
                cartTitle: "–ö–æ—Ä–∑–∏–Ω–∞",
                back: "–ù–∞–∑–∞–¥",
                checkoutTitle: "–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞",
                authTitle: "–í—Ö–æ–¥ / –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è",
                profileTitle: "–ü—Ä–æ—Ñ–∏–ª—å",
                receiptTitle: "–ß–µ–∫ –∑–∞–∫–∞–∑–∞",
                nameLabel: "–ò–º—è:",
                phoneLabel: "–¢–µ–ª–µ—Ñ–æ–Ω:",
                footerContactTitle: "–ö–æ–Ω—Ç–∞–∫—Ç—ã",
                footerLinksTitle: "–°—Å—ã–ª–∫–∏",
                footerSocialTitle: "–°–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–µ—Ç–∏",
                footerContact: "support@shop.com",
                footerLinks: "<a href='#' class='underline'>–û –Ω–∞—Å</a><br><a href='#' class='underline'>–£—Å–ª–æ–≤–∏—è</a><br><a href='#' class='underline'>–ö–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å</a>",
                footerCopyright: "¬© 2025 –ò–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.",
                searchPlaceholder: "–ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤...",
                close: "–ó–∞–∫—Ä—ã—Ç—å",
                checkout: "–û—Ñ–æ—Ä–º–∏—Ç—å",
                placeOrder: "–†–∞–∑–º–µ—Å—Ç–∏—Ç—å –∑–∞–∫–∞–∑",
                cancel: "–û—Ç–º–µ–Ω–∞",
                login: "–í–æ–π—Ç–∏",
                editProfile: "–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å",
                logout: "–í—ã–π—Ç–∏",
                addToCart: "–í –∫–æ—Ä–∑–∏–Ω—É",
                remove: "–£–¥–∞–ª–∏—Ç—å",
                applyDiscount: "–ü—Ä–∏–º–µ–Ω–∏—Ç—å",
                downloadReceipt: "–°–∫–∞—á–∞—Ç—å —á–µ–∫",
                discountPlaceholder: "–í–≤–µ–¥–∏—Ç–µ –ø—Ä–æ–º–æ–∫–æ–¥",
                firstNamePlaceholder: "–ò–º—è",
                lastNamePlaceholder: "–§–∞–º–∏–ª–∏—è",
                phonePlaceholder: "–ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞",
                smsCodePlaceholder: "–ö–æ–¥ –∏–∑ SMS",
                addressPlaceholder: "–ê–¥—Ä–µ—Å",
                cash: "–ù–∞–ª–∏—á–Ω—ã–µ",
                card: "–ö–∞—Ä—Ç–∞",
                credit: "–ö—Ä–µ–¥–∏—Ç",
                cardNumberPlaceholder: "–ù–æ–º–µ—Ä –∫–∞—Ä—Ç—ã",
                cardExpiryPlaceholder: "–ú–ú/–ì–ì",
                cardCVVPlaceholder: "CVV",
                carat: "–ö–∞—Ä–∞—Ç",
                passportIdPlaceholder: "–ü–∞—Å–ø–æ—Ä—Ç ID",
                googleLogin: "–í–æ–π—Ç–∏ —á–µ—Ä–µ–∑ Google",
                faceIdLogin: "–í–æ–π—Ç–∏ —Å Face ID",
                faceIdCheckout: "–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å —Å Face ID",
                faceIdText: "–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ —Å –ø–æ–º–æ—â—å—é Face ID",
                confirmFaceId: "–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å",
                cancelFaceId: "–û—Ç–º–µ–Ω–∞",
                passwordPlaceholder: "–ü–∞—Ä–æ–ª—å",
                smsSent: "–ö–æ–¥ SMS –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω: ",
                invalidSMS: "–ù–µ–≤–µ—Ä–Ω—ã–π –∫–æ–¥ SMS",
                orderSuccess: "–ó–∞–∫–∞–∑ —É—Å–ø–µ—à–Ω–æ —Ä–∞–∑–º–µ—â–µ–Ω!",
                faceIdSuccess: "Face ID –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω!",
                faceIdFailed: "Face ID –Ω–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.",
                invalidDiscount: "–ù–µ–≤–µ—Ä–Ω—ã–π –ø—Ä–æ–º–æ–∫–æ–¥",
                discountApplied: "–°–∫–∏–¥–∫–∞ –ø—Ä–∏–º–µ–Ω–µ–Ω–∞: 10%!",
                catManga: "–ú–∞–Ω–≥–∞",
                catClothing: "–û–¥–µ–∂–¥–∞",
                catFootwear: "–û–±—É–≤—å",
                catFood: "–ï–¥–∞",
                subKfc: "KFC",
                subOtherRestaurants: "–î—Ä—É–≥–∏–µ —Ä–µ—Å—Ç–æ—Ä–∞–Ω—ã",
                subShonen: "–°—ë–Ω–µ–Ω",
                subSeinen: "–°—ç–π–Ω—ç–Ω",
                subTShirts: "–§—É—Ç–±–æ–ª–∫–∏",
                subJeans: "–î–∂–∏–Ω—Å—ã",
                subSneakers: "–ö—Ä–æ—Å—Å–æ–≤–∫–∏",
                subBoots: "–°–∞–ø–æ–≥–∏",
                receiptItems: "–¢–æ–≤–∞—Ä—ã:",
                receiptTotal: "–ò—Ç–æ–≥–æ:",
                receiptCustomer: "–ü–æ–∫—É–ø–∞—Ç–µ–ª—å:",
                receiptPhone: "–¢–µ–ª–µ—Ñ–æ–Ω:",
                receiptAddress: "–ê–¥—Ä–µ—Å:",
                receiptPayment: "–û–ø–ª–∞—Ç–∞:",
                receiptCarat: "–ö–∞—Ä–∞—Ç:",
                receiptPassportId: "–ü–∞—Å–ø–æ—Ä—Ç ID:"
            },
            uz: {
                siteTitle: "Internet Do'kon",
                catalogTitle: "Mahsulotlar Katalogi",
                cartTitle: "Savat",
                back: "Orqaga",
                checkoutTitle: "Buyurtma berish",
                authTitle: "Kirish / Ro'yxatdan o'tish",
                profileTitle: "Profil",
                receiptTitle: "Buyurtma Cheki",
                nameLabel: "Ism:",
                phoneLabel: "Telefon:",
                footerContactTitle: "Aloqa",
                footerLinksTitle: "Havolalar",
                footerSocialTitle: "Ijtimoiy tarmoqlar",
                footerContact: "support@shop.com",
                footerLinks: "<a href='#' class='underline'>Haqimizda</a><br><a href='#' class='underline'>Shartlar</a><br><a href='#' class='underline'>Maxfiylik</a>",
                footerCopyright: "¬© 2025 Internet Do'kon. Barcha huquqlar himoyalangan.",
                searchPlaceholder: "Mahsulot qidirish...",
                close: "Yopish",
                checkout: "Buyurtma berish",
                placeOrder: "Buyurtma joylashtirish",
                cancel: "Bekor qilish",
                login: "Kirish",
                editProfile: "Profilni tahrirlash",
                logout: "Chiqish",
                addToCart: "Savatchaga qo'shish",
                remove: "O'chirish",
                applyDiscount: "Qo'llash",
                downloadReceipt: "Chekni yuklash",
                discountPlaceholder: "Promokod kiriting",
                firstNamePlaceholder: "Ism",
                lastNamePlaceholder: "Familiya",
                phonePlaceholder: "Telefon raqami",
                smsCodePlaceholder: "SMS kodi",
                addressPlaceholder: "Manzil",
                cash: "Naqd",
                card: "Karta",
                credit: "Kredit",
                cardNumberPlaceholder: "Karta raqami",
                cardExpiryPlaceholder: "MM/YY",
                cardCVVPlaceholder: "CVV",
                carat: "Karat",
                passportIdPlaceholder: "Pasport ID",
                googleLogin: "Google orqali kirish",
                faceIdLogin: "Face ID bilan kirish",
                faceIdCheckout: "Face ID bilan tasdiqlash",
                faceIdText: "Face ID bilan tasdiqlang",
                confirmFaceId: "Tasdiqlash",
                cancelFaceId: "Bekor qilish",
                passwordPlaceholder: "Parol",
                smsSent: "SMS kodi yuborildi: ",
                invalidSMS: "Noto'g'ri SMS kod",
                orderSuccess: "Buyurtma muvaffaqiyatli joylashtirildi!",
                faceIdSuccess: "Face ID tasdiqlandi!",
                faceIdFailed: "Face ID tasdiqlanmadi. Qayta urinib ko'ring.",
                invalidDiscount: "Noto'g'ri promokod",
                discountApplied: "Chegirma qo'llanildi: 10%!",
                catManga: "Manga",
                catClothing: "Kiyim",
                catFootwear: "Poyabzal",
                catFood: "Oziq-ovqat",
                subKfc: "KFC",
                subOtherRestaurants: "Boshqa restoranlar",
                subShonen: "Shonen",
                subSeinen: "Seinen",
                subTShirts: "Futbolkalar",
                subJeans: "Jinsilar",
                subSneakers: "Krossovkalar",
                subBoots: "Etiklar",
                receiptItems: "Mahsulotlar:",
                receiptTotal: "Jami:",
                receiptCustomer: "Xaridor:",
                receiptPhone: "Telefon:",
                receiptAddress: "Manzil:",
                receiptPayment: "To'lov:",
                receiptCarat: "Karat:",
                receiptPassportId: "Pasport ID:"
            }
        };

        let cart = [];
        let user = null;
        let currentLang = 'ru';
        let discount = 0;
        let smsCode = null;
        let lastOrder = null;
        let activeCategory = null;
        let faceIdVerified = false;
        let faceIdContext = null; // 'login' or 'checkout'

        // Generate random SMS code
        function generateSMSCode() {
            return Math.floor(1000 + Math.random() * 9000).toString();
        }

        // Simulate Face ID
        function simulateFaceID(context, callback) {
            faceIdContext = context;
            document.getElementById('faceIdText').textContent = translations[currentLang].faceIdText;
            openModal('faceIdModal');
            document.getElementById('confirmFaceId').onclick = () => {
                // Simulate successful Face ID (in a real app, this would use WebAuthn or native APIs)
                faceIdVerified = Math.random() > 0.2; // 80% success rate for demo
                closeModal('faceIdModal');
                if (faceIdVerified) {
                    alert(translations[currentLang].faceIdSuccess);
                    callback();
                } else {
                    alert(translations[currentLang].faceIdFailed);
                }
            };
            document.getElementById('cancelFaceId').onclick = () => {
                closeModal('faceIdModal');
            };
        }

        // Load products
        function loadProducts(productsToDisplay = products) {
            const productList = document.getElementById('productList');
            productList.innerHTML = '';
            let filteredProducts = productsToDisplay;
            if (!activeCategory) {
                filteredProducts = productsToDisplay.filter(p => p.category !== 'food' && p.category !== 'kfc');
            }
            filteredProducts.forEach(product => {
                const productCard = `
                    <div class="product-card">
                        <img src="${product.image}" alt="${product.title}" loading="lazy">
                        <h3 class="product-name">${product.title}</h3>
                        <p class="description">${product.description}</p>
                        <p class="price">$${product.price.toFixed(2)}</p>
                        <button onclick="addToCart(${product.id})">${translations[currentLang].addToCart}</button>
                    </div>
                `;
                productList.innerHTML += productCard;
            });
        }

        // Add to cart
        function addToCart(id) {
            const product = products.find(p => p.id === id);
            if (!product) return;
            const cartItem = cart.find(item => item.id === id);
            if (cartItem) {
                cartItem.quantity++;
            } else {
                cart.push({ ...product, quantity: 1 });
            }
            document.getElementById('cartButton').classList.add('shake');
            setTimeout(() => document.getElementById('cartButton').classList.remove('shake'), 300);
            updateCart();
        }

        // Update cart content
        function updateCart() {
            const cartItems = document.getElementById('cartItems');
            const cartCount = document.getElementById('cartCount');
            const cartTotal = document.getElementById('cartTotal');
            cartItems.innerHTML = '';
            let total = 0;
            cart.forEach(item => {
                total += item.price * item.quantity;
                cartItems.innerHTML += `
                    <div class="flex justify-between items-center mb-2 text-sm">
                        <span>${item.title} (x${item.quantity})</span>
                        <div class="flex gap-2">
                            <button type="button" onclick="updateQuantity(${item.id}, -1)" class="bg-[#B0BEC5] text-white px-2 py-1 rounded-sm text-xs">-</button>
                            <button type="button" onclick="updateQuantity(${item.id}, 1)" class="bg-[#B0BEC5] text-white px-2 py-1 rounded-sm text-xs">+</button>
                            <button type="button" onclick="removeFromCart(${item.id})" class="bg-[#FF3B3B] text-white px-2 py-1 rounded-sm text-xs">${translations[currentLang].remove}</button>
                        </div>
                    </div>
                `;
            });
            total = total * (1 - discount);
            cartCount.textContent = cart.reduce((sum, item) => sum + item.quantity, 0);
            cartTotal.textContent = `${translations[currentLang].receiptTotal}: $${total.toFixed(2)}`;
        }

        // Update quantity
        function updateQuantity(id, change) {
            const cartItem = cart.find(item => item.id === id);
            if (cartItem) {
                cartItem.quantity += change;
                if (cartItem.quantity <= 0) {
                    cart = cart.filter(item => item.id !== id);
                }
                updateCart();
            }
        }

        // Remove from cart
        function removeFromCart(id) {
            cart = cart.filter(item => item.id !== id);
            updateCart();
        }

        // Apply discount
        document.getElementById('applyDiscount').addEventListener('click', () => {
            const code = document.getElementById('discountCode').value;
            if (code === 'SAVE10') {
                discount = 0.1;
                alert(translations[currentLang].discountApplied);
            } else {
                discount = 0;
                alert(translations[currentLang].invalidDiscount);
            }
            updateCart();
        });

        // Search functionality
        document.getElementById('search').addEventListener('input', (e) => {
            const query = e.target.value.toLowerCase();
            const filteredProducts = products.filter(product =>
                (product.title && product.title.toLowerCase().includes(query)) ||
                (product.description && product.description.toLowerCase().includes(query))
            );
            loadProducts(filteredProducts);
        });

        // Language switcher
        document.getElementById('languageSelect').addEventListener('change', (e) => {
            currentLang = e.target.value;
            updateLanguage();
        });

        function updateLanguage() {
            document.getElementById('siteTitle').textContent = translations[currentLang].siteTitle;
            document.getElementById('catalogTitle').textContent = translations[currentLang].catalogTitle;
            document.getElementById('cartTitle').textContent = translations[currentLang].cartTitle;
            document.getElementById('checkoutTitle').textContent = translations[currentLang].checkoutTitle;
            document.getElementById('authTitle').textContent = translations[currentLang].authTitle;
            document.getElementById('profileTitle').textContent = translations[currentLang].profileTitle;
            document.getElementById('receiptTitle').textContent = translations[currentLang].receiptTitle;
            document.getElementById('nameLabel').textContent = translations[currentLang].nameLabel;
            document.getElementById('phoneLabel').textContent = translations[currentLang].phoneLabel;
            document.getElementById('footerContactTitle').textContent = translations[currentLang].footerContactTitle;
            document.getElementById('footerContact').innerHTML = translations[currentLang].footerContact;
            document.getElementById('footerLinksTitle').textContent = translations[currentLang].footerLinksTitle;
            document.getElementById('footerLinks').innerHTML = translations[currentLang].footerLinks;
            document.getElementById('footerSocialTitle').textContent = translations[currentLang].footerSocialTitle;
            document.getElementById('footerCopyright').textContent = translations[currentLang].footerCopyright;
            document.getElementById('search').placeholder = translations[currentLang].searchPlaceholder;
            document.getElementById('closeCart').textContent = translations[currentLang].close;
            document.getElementById('checkoutButton').textContent = translations[currentLang].checkout;
            document.getElementById('closeCheckout').textContent = translations[currentLang].cancel;
            document.querySelector('#checkoutForm button[type="submit"]').textContent = translations[currentLang].placeOrder;
            document.getElementById('closeAuth').textContent = translations[currentLang].cancel;
            document.querySelector('#authForm button[type="submit"]').textContent = translations[currentLang].login;
            document.getElementById('editProfile').textContent = translations[currentLang].editProfile;
            document.getElementById('logoutButton').textContent = translations[currentLang].logout;
            document.getElementById('applyDiscount').textContent = translations[currentLang].applyDiscount;
            document.getElementById('downloadReceipt').textContent = translations[currentLang].downloadReceipt;
            document.getElementById('closeReceipt').textContent = translations[currentLang].close;
            document.getElementById('discountCode').placeholder = translations[currentLang].discountPlaceholder;
            document.getElementById('firstName').placeholder = translations[currentLang].firstNamePlaceholder;
            document.getElementById('lastName').placeholder = translations[currentLang].lastNamePlaceholder;
            document.getElementById('phone').placeholder = translations[currentLang].phonePlaceholder;
            document.getElementById('smsCode').placeholder = translations[currentLang].smsCodePlaceholder;
            document.getElementById('address').placeholder = translations[currentLang].addressPlaceholder;
            document.getElementById('paymentMethod').options[0].textContent = translations[currentLang].cash;
            document.getElementById('paymentMethod').options[1].textContent = translations[currentLang].card;
            document.getElementById('paymentMethod').options[2].textContent = translations[currentLang].credit;
            document.getElementById('cardNumber').placeholder = translations[currentLang].cardNumberPlaceholder;
            document.getElementById('cardExpiry').placeholder = translations[currentLang].cardExpiryPlaceholder;
            document.getElementById('cardCVV').placeholder = translations[currentLang].cardCVVPlaceholder;
            document.querySelector('label[for="carat"]').textContent = translations[currentLang].carat;
            document.getElementById('passportId').placeholder = translations[currentLang].passportIdPlaceholder;
            document.getElementById('googleLogin').textContent = translations[currentLang].googleLogin;
            document.getElementById('faceIdLogin').textContent = translations[currentLang].faceIdLogin;
            document.getElementById('faceIdCheckout').textContent = translations[currentLang].faceIdCheckout;
            document.getElementById('authFirstName').placeholder = translations[currentLang].firstNamePlaceholder;
            document.getElementById('authPhone').placeholder = translations[currentLang].phonePlaceholder;
            document.getElementById('authPassword').placeholder = translations[currentLang].passwordPlaceholder;
            document.getElementById('cat-manga').childNodes[0].textContent = translations[currentLang].catManga;
            document.getElementById('cat-clothing').childNodes[0].textContent = translations[currentLang].catClothing;
            document.getElementById('cat-footwear').childNodes[0].textContent = translations[currentLang].catFootwear;
            document.getElementById('cat-food').childNodes[0].textContent = translations[currentLang].catFood;
            document.getElementById('sub-kfc').textContent = translations[currentLang].subKfc;
            document.getElementById('sub-other-restaurants').textContent = translations[currentLang].subOtherRestaurants;
            document.getElementById('catalog-back').textContent = translations[currentLang].back;
            document.querySelectorAll('#catalog-sidebar .catalog-subitems')[0].children[0].textContent = translations[currentLang].subShonen;
            document.querySelectorAll('#catalog-sidebar .catalog-subitems')[0].children[1].textContent = translations[currentLang].subSeinen;
            document.querySelectorAll('#catalog-sidebar .catalog-subitems')[1].children[0].textContent = translations[currentLang].subTShirts;
            document.querySelectorAll('#catalog-sidebar .catalog-subitems')[1].children[1].textContent = translations[currentLang].subJeans;
            document.querySelectorAll('#catalog-sidebar .catalog-subitems')[2].children[0].textContent = translations[currentLang].subSneakers;
            document.querySelectorAll('#catalog-sidebar .catalog-subitems')[2].children[1].textContent = translations[currentLang].subBoots;
            updateProfile();
            loadProducts(activeCategory ? products.filter(p => p.category === activeCategory) : products);
            updateCart();
        }

        // Modal handling
        function openModal(modalId) {
            document.getElementById(modalId).style.display = 'flex';
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        // Catalog sidebar
        document.getElementById('catalogButton').addEventListener('click', () => {
            document.getElementById('catalog-sidebar').classList.add('active');
            document.getElementById('catalog-overlay').classList.add('active');
        });

        document.getElementById('catalog-close').addEventListener('click', () => {
            document.getElementById('catalog-sidebar').classList.remove('active');
            document.getElementById('catalog-overlay').classList.remove('active');
            activeCategory = null;
            document.getElementById('catalog-back').style.display = 'none';
            document.querySelectorAll('.catalog-subitems').forEach(subitems => {
                subitems.classList.remove('active');
            });
            loadProducts();
        });

        document.getElementById('catalog-overlay').addEventListener('click', () => {
            document.getElementById('catalog-sidebar').classList.remove('active');
            document.getElementById('catalog-overlay').classList.remove('active');
            activeCategory = null;
            document.getElementById('catalog-back').style.display = 'none';
            document.querySelectorAll('.catalog-subitems').forEach(subitems => {
                subitems.classList.remove('active');
            });
            loadProducts();
        });

        // Back button
        document.getElementById('catalog-back').addEventListener('click', () => {
            document.querySelectorAll('.catalog-subitems').forEach(subitems => {
                subitems.classList.remove('active');
            });
            document.getElementById('catalog-back').style.display = 'none';
            activeCategory = null;
            loadProducts();
        });

        // Catalog filtering
        document.querySelectorAll('.catalog-item-header').forEach(header => {
            header.addEventListener('click', () => {
                const subitems = header.nextElementSibling;
                document.querySelectorAll('.catalog-subitems').forEach(item => {
                    if (item !== subitems) item.classList.remove('active');
                });
                subitems.classList.add('active');
                
                const categoryId = header.id;
                let filteredProducts = products;
                activeCategory = null;

                if (categoryId === 'cat-manga') {
                    filteredProducts = products.filter(p => p.category === 'manga');
                    activeCategory = 'manga';
                } else if (categoryId === 'cat-clothing') {
                    filteredProducts = products.filter(p => p.category === 'clothing');
                    activeCategory = 'clothing';
                } else if (categoryId === 'cat-footwear') {
                    filteredProducts = products.filter(p => p.category === 'footwear');
                    activeCategory = 'footwear';
                } else if (categoryId === 'cat-food') {
                    filteredProducts = [];
                    document.getElementById('catalog-back').style.display = 'block';
                }

                loadProducts(filteredProducts);
            });
        });

        // Subitem filtering for food category
        document.getElementById('sub-kfc').addEventListener('click', () => {
            const filteredProducts = products.filter(p => p.category === 'kfc');
            activeCategory = 'kfc';
            document.getElementById('catalog-back').style.display = 'block';
            loadProducts(filteredProducts);
        });

        document.getElementById('sub-other-restaurants').addEventListener('click', () => {
            const filteredProducts = products.filter(p => p.category === 'food');
            activeCategory = 'food';
            document.getElementById('catalog-back').style.display = 'block';
            loadProducts(filteredProducts);
        });

        // Cart modal
        document.getElementById('cartButton').addEventListener('click', () => {
            if (cart.length === 0) {
                alert(translations[currentLang].cartEmpty);
                return;
            }
            if (!user) {
                openModal('authModal');
            } else {
                openModal('cartModal');
            }
        });

        document.getElementById('closeCart').addEventListener('click', () => closeModal('cartModal'));

        // Checkout modal
        document.getElementById('checkoutButton').addEventListener('click', () => {
            if (!user) {
                openModal('authModal');
                return;
            }
            closeModal('cartModal');
            openModal('checkoutModal');
            document.getElementById('firstName').value = user.firstName;
            document.getElementById('phone').value = user.phone;
        });

        document.getElementById('closeCheckout').addEventListener('click', () => closeModal('checkoutModal'));

        // SMS code generation
        document.getElementById('phone').addEventListener('blur', () => {
            if (document.getElementById('phone').value) {
                smsCode = generateSMSCode();
                alert(`${translations[currentLang].smsSent}${smsCode}`);
            }
        });

        // Payment method toggle
        document.getElementById('paymentMethod').addEventListener('change', (e) => {
            const value = e.target.value;
            document.getElementById('cardDetails').classList.toggle('hidden', value !== 'card');
            document.getElementById('creditDetails').classList.toggle('hidden', value !== 'credit');
        });

        // Face ID for checkout
        document.getElementById('faceIdCheckout').addEventListener('click', () => {
            simulateFaceID('checkout', () => {
                document.getElementById('checkoutForm').dispatchEvent(new Event('submit'));
            });
        });

        // Checkout form submission
        document.getElementById('checkoutForm').addEventListener('submit', (e) => {
            e.preventDefault();
            if (!faceIdVerified) {
                alert(translations[currentLang].faceIdText);
                return;
            }
            const inputCode = document.getElementById('smsCode').value;
            if (inputCode !== smsCode) {
                alert(translations[currentLang].invalidSMS);
                return;
            }
            const paymentMethod = document.getElementById('paymentMethod').value;
            if (paymentMethod === 'card') {
                const cardNumber = document.getElementById('cardNumber').value;
                const cardExpiry = document.getElementById('cardExpiry').value;
                const cardCVV = document.getElementById('cardCVV').value;
                if (!/^\d{16}$/.test(cardNumber) || !/^\d{2}\/\d{2}$/.test(cardExpiry) || !/^\d{3}$/.test(cardCVV)) {
                    alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–∞–Ω–Ω—ã–µ –∫–∞—Ä—Ç—ã.');
                    return;
                }
            } else if (paymentMethod === 'credit') {
                const cardNumber = document.getElementById('cardNumber').value;
                const cardExpiry = document.getElementById('cardExpiry').value;
                const cardCVV = document.getElementById('cardCVV').value;
                const passportId = document.getElementById('passportId').value;
                if (!/^\d{16}$/.test(cardNumber) || !/^\d{2}\/\d{2}$/.test(cardExpiry) || !/^\d{3}$/.test(cardCVV) || !/^[A-Z0-9]{9}$/.test(passportId)) {
                    alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–∞–Ω–Ω—ã–µ –∫–∞—Ä—Ç—ã –∏ –ø–∞—Å–ø–æ—Ä—Ç ID.');
                    return;
                }
            }
            const firstName = document.getElementById('firstName').value;
            const lastName = document.getElementById('lastName').value;
            const phone = document.getElementById('phone').value;
            const address = document.getElementById('address').value;
            lastOrder = {
                items: [...cart],
                total: cart.reduce((sum, item) => sum + item.price * item.quantity, 0) * (1 - discount),
                customer: `${firstName} ${lastName}`,
                phone,
                address,
                payment: paymentMethod
            };
            if (paymentMethod === 'credit') {
                lastOrder.carat = document.getElementById('carat').value;
                lastOrder.passportId = document.getElementById('passportId').value;
            }
            if (!user) {
                user = { firstName, phone };
                updateProfile();
            }
            showReceipt();
            alert(translations[currentLang].orderSuccess);
            cart = [];
            discount = 0;
            smsCode = null;
            faceIdVerified = false;
            document.getElementById('checkoutForm').reset();
            document.getElementById('cardDetails').classList.add('hidden');
            document.getElementById('creditDetails').classList.add('hidden');
            updateCart();
            closeModal('checkoutModal');
        });

        // Show receipt
        function showReceipt() {
            const receiptContent = document.getElementById('receiptContent');
            let receiptHTML = `
                <p><strong>${translations[currentLang].receiptItems}</strong></p>
                ${lastOrder.items.map(item => `<p>${item.title} (x${item.quantity}) - $${(item.price * item.quantity).toFixed(2)}</p>`).join('')}
                <p><strong>${translations[currentLang].receiptTotal}</strong> $${lastOrder.total.toFixed(2)}</p>
                <p><strong>${translations[currentLang].receiptCustomer}</strong> ${lastOrder.customer}</p>
                <p><strong>${translations[currentLang].receiptPhone}</strong> ${lastOrder.phone}</p>
                <p><strong>${translations[currentLang].receiptAddress}</strong> ${lastOrder.address}</p>
                <p><strong>${translations[currentLang].receiptPayment}</strong> ${translations[currentLang][lastOrder.payment]}</p>
            `;
            if (lastOrder.payment === 'credit') {
                receiptHTML += `
                    <p><strong>${translations[currentLang].receiptCarat}</strong> ${lastOrder.carat}</p>
                    <p><strong>${translations[currentLang].receiptPassportId}</strong> ${lastOrder.passportId}</p>
                `;
            }
            receiptContent.innerHTML = receiptHTML;
            openModal('receiptModal');
        }

        // Download receipt
        document.getElementById('downloadReceipt').addEventListener('click', () => {
            let receiptText = `
${translations[currentLang].receiptTitle}
${translations[currentLang].receiptItems}
${lastOrder.items.map(item => `${item.title} (x${item.quantity}) - $${(item.price * item.quantity).toFixed(2)}`).join('\n')}
${translations[currentLang].receiptTotal} $${lastOrder.total.toFixed(2)}
${translations[currentLang].receiptCustomer} ${lastOrder.customer}
${translations[currentLang].receiptPhone} ${lastOrder.phone}
${translations[currentLang].receiptAddress} ${lastOrder.address}
${translations[currentLang].receiptPayment} ${translations[currentLang][lastOrder.payment]}
            `;
            if (lastOrder.payment === 'credit') {
                receiptText += `
${translations[currentLang].receiptCarat} ${lastOrder.carat}
${translations[currentLang].receiptPassportId} ${lastOrder.passportId}
            `;
            }
            const blob = new Blob([receiptText], { type: 'text/plain' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = 'receipt.txt';
            link.click();
            URL.revokeObjectURL(link.href);
        });

        document.getElementById('closeReceipt').addEventListener('click', () => closeModal('receiptModal'));

        // Auth modal
        document.getElementById('authButton').addEventListener('click', () => openModal('authModal'));

        document.getElementById('closeAuth').addEventListener('click', () => closeModal('authModal'));

        // Google login
        document.getElementById('googleLogin').addEventListener('click', () => {
            user = { firstName: 'Google –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å', phone: '+1234567890' };
            updateProfile();
            closeModal('authModal');
        });

        // Face ID login
        document.getElementById('faceIdLogin').addEventListener('click', () => {
            simulateFaceID('login', () => {
                user = { firstName: 'FaceID –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å', phone: '+1234567890' };
                updateProfile();
                closeModal('authModal');
            });
        });

        // Auth form submission
        document.getElementById('authForm').addEventListener('submit', (e) => {
            e.preventDefault();
            const firstName = document.getElementById('authFirstName').value;
            const phone = document.getElementById('authPhone').value;
            user = { firstName, phone: phone || '+1234567890' };
            updateProfile();
            closeModal('authModal');
        });

        // Profile handling
        function updateProfile() {
            const profileSection = document.getElementById('profileSection');
            const profileName = document.getElementById('profileName');
            const profilePhone = document.getElementById('profilePhone');
            const authButton = document.getElementById('authButton');

            if (user) {
                profileSection.classList.remove('hidden');
                profileName.textContent = user.firstName;
                profilePhone.textContent = user.phone;
                authButton.textContent = user.firstName;
            } else {
                profileSection.classList.add('hidden');
                authButton.textContent = translations[currentLang].login;
            }
        }

        document.getElementById('editProfile').addEventListener('click', () => {
            document.getElementById('authFirstName').value = user.firstName;
            document.getElementById('authPhone').value = user.phone;
            openModal('authModal');
        });

        document.getElementById('logoutButton').addEventListener('click', () => {
            user = null;
            updateProfile();
        });

        // Mobile touch optimization
        document.addEventListener('touchstart', (e) => {
            if (e.touches.length > 1) {
                e.preventDefault();
            }
        }, { passive: false });

        // Initialize page
        loadProducts();
        updateLanguage();
    </script>
</body>
</html>